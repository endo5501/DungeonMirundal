---
priority: 2
tags: ["feature", "ui", "church", "shop", "prayer", "item"]
description: "教会の祈祷書購入パネルの実装"
created_at: "2025-07-21T06:30:51Z"
started_at: null  # Do not modify manually
closed_at: null   # Do not modify manually
---

# Ticket Overview

教会の祈祷書購入機能が未実装となっている。祈祷書は僧侶系キャラクターが新しい祈祷呪文を習得するために必要なアイテムである。この機能により、プレイヤーは教会で祈祷書を購入し、キャラクターの呪文レパートリーを拡充できるようになる。

## 背景
- 教会のサービスパネルに「祈祷書購入」ボタンは存在するが、機能が未実装
- 祈祷書は僧侶系職業のキャラクターのみが使用可能
- 祈祷書のレベルに応じて習得可能な呪文と価格が異なる
- 商店とは異なり、教会でのみ聖なるアイテムとして販売

## Tasks

- [ ] 現在の教会UIと祈祷呪文システムの実装状況を調査
- [ ] 祈祷書アイテムのデータ構造設計
- [ ] 祈祷書リストUIの設計と実装
- [ ] キャラクターの祈祷習得可否判定ロジック
- [ ] 祈祷書の在庫管理システム（無限/有限）
- [ ] 購入対象キャラクター選択UI
- [ ] 祈祷書詳細表示機能（習得可能呪文一覧）
- [ ] 購入確認ダイアログの実装
- [ ] 購入処理とインベントリへの追加
- [ ] 購入制限のバリデーション（レベル、職業）
- [ ] 所持金不足時のエラーハンドリング
- [ ] 購入成功/失敗メッセージの表示
- [ ] 祈祷書の価格設定と表示
- [ ] 日本語テキストの実装（祈祷書名、説明文）
- [ ] ユニットテストの作成
- [ ] 統合テストの実施
- [ ] Run tests before closing and pass all tests (No exceptions)
- [ ] Get developer approval before closing

## 受け入れ条件
- [ ] 購入可能な祈祷書の一覧が表示される
- [ ] 各祈祷書の価格と習得可能呪文が確認できる
- [ ] 購入対象キャラクターを選択できる
- [ ] 僧侶系職業のみが購入可能（制限機能）
- [ ] キャラクターレベルに応じた祈祷書のみ購入可能
- [ ] 所持金が足りない場合は購入できない
- [ ] 購入した祈祷書がインベントリに追加される
- [ ] すべてのテキストが日本語で表示される

## Notes

- 祈祷書のレベル構成例：
  - 初級祈祷書（Lv1-3呪文）：500G
  - 中級祈祷書（Lv4-5呪文）：2000G
  - 上級祈祷書（Lv6-7呪文）：5000G
- 祈祷書は使用することで呪文を習得（別機能）
- 既に習得済みの呪文の祈祷書も購入可能（無駄になる）
- 在庫は基本的に無限とする（教会の恩恵）
- 将来的には特殊な祈祷書（イベント限定等）の追加も検討
