# Phase 3: 地上部 TODO (期間: 3週間)

## 概要
地上部の各施設システムとアイテム管理の実装

## ゲームシステム仕様変更
- **地上部帰還時の自動回復**: ダンジョンから地上部に戻った際、HP・MP全回復、死亡・灰化以外の状態異常を自動解除
- **宿屋の役割変更**: 休息による回復システムは不要（自動回復のため）、アイテム預かりと魔法スロット設定に特化

## TODO リスト

### 施設システム基盤
- [x] 施設基底クラス（`BaseFacility`）の実装
- [x] 施設間ナビゲーションシステム
- [x] 施設UIの共通フレームワーク

### 冒険者ギルド
- [x] ギルド基本機能の実装
- [x] キャラクター作成インターフェース
- [x] パーティ編成インターフェース
- [x] クラスチェンジシステム（基本UI、機能はPhase 4で実装）
- [x] キャラクター一覧・詳細表示

### 宿屋 ✅ **完了**
- [x] 宿屋基本機能の実装
- [x] 情報提供・雰囲気作りの場として実装（アイテム預かりはPhase 4で実装）
- [x] 魔術・祈祷スロット設定UI（Phase 4で実装済み）

### 商店 🔄 **部分完了**
- [x] 商店基本機能の実装
- [x] アイテム購入システム
- [x] 価格計算システム
- [x] 在庫管理システム
- [ ] アイテム売却機能（基本実装済み、完全機能は未完成）
- [ ] 未鑑定アイテム鑑定機能（基本実装済み、完全機能は未完成）

### 教会
- [x] 教会基本機能の実装
- [x] キャラクター蘇生システム（DEAD/ASHES対応）
- [x] 祝福システム
- [x] 状態異常治療システム
- [x] 寄付システム

### 魔術師ギルド
- [x] 魔術師ギルド基本機能の実装
- [x] 魔術習得システム（基本UI）
- [x] 魔法書購入インターフェース
- [x] 魔術レベル制限システム
- [x] 魔法適性分析システム

### アイテムシステム ✅ **完了**
- [x] `Item` クラスの実装
- [x] アイテム分類（武器、防具、消費アイテム、魔法書、道具）
- [x] アイテム属性システム（物理、炎、氷、雷）
- [x] アイテム定義ファイル（YAML）の作成
- [x] アイテム鑑定システム
- [x] アイテム修理システム
- [x] インベントリ管理（キャラクター10個制限）（Phase 4で実装完了）
- [x] 装備システム（Phase 4で実装完了）

### 地上部管理 🔄 **部分完了**
- [x] `OverworldManager` クラスの実装
- [x] 地上部帰還時の自動回復システム（HP全回復、MP全回復、死亡・灰化以外の状態異常解除）
- [x] 施設間移動システム
- [ ] 地上部BGM・効果音システム（未実装）

## 完了条件 ✅ **主要項目完了**
- [x] 全ての施設が正常に機能する
- [x] アイテム購入システムが動作する（売却はPhase 4で実装完了）
- [x] キャラクター蘇生システムが動作する
- [x] 魔術・祈祷習得UI が機能する（Phase 4で詳細実装完了）
- [x] 地上部のユーザーフロー完成
- [x] 自動回復システムが正常に動作する
- [x] 全30個のテストが通過する

## 🔄 **Phase 6への移行項目**
- アイテム売却機能の完成（基本実装済み）
- アイテム鑑定機能の完成（基本実装済み）
- 地上部BGM・効果音システム

## Phase 3 実装完了 (2025-06-14)

**実装された主な機能:**
- 施設基底クラス（BaseFacility）とFacilityManager
- 地上部管理システム（OverworldManager）とダンジョン帰還時の自動回復
- アイテムシステム（Item、ItemManager）
- 冒険者ギルド（キャラクター作成・パーティ編成）
- 宿屋（情報提供と雰囲気作り）
- 商店（アイテム購入システム）
- 教会（蘇生・治療・祝福サービス）
- 魔術師ギルド（魔法習得・分析システム）
- 包括的なテストスイート（30個のテストすべて通過）

**Phase 4への引き継ぎ事項:**
- インベントリシステムの実装
- 装備システムの実装
- 魔法・祈祷の詳細システム
- アイテム売却機能の完成

## 次フェーズへの引き継ぎ事項
- 完成した地上部システム
- 動作するアイテム管理
- 整備されたキャラクター管理UI