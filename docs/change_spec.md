# Change Specification

変更を希望する仕様について記述する
新仕様(New Specifications)に記載されている仕様を検討し、修正を行ってください
修正後、必ずテストを実施し、変更された仕様(Changed Specifications)へ移動してください

## New Specifications

(すべて実装完了)


## Changed Specifications

- [x] 地上メニューのボタンの文字の縦横を同じ比率に表示してほしい
  - 実装完了: `src/ui/base_ui.py`でボタンサイズを`(0.45, 0.22)`から`(0.35, 0.35)`（正方形）に変更
  - キャラクター作成画面も`(0.35, 0.18)`から`(0.28, 0.28)`（正方形）に変更
  
- [x] 地上メニューのボタンをもう少し小さくしてほしい
  - 実装完了: 通常ボタンサイズを0.45→0.35、キャラクター作成ボタンサイズを0.35→0.28に縮小
  - より簡潔なUI表示を実現
  
- [x] ゲーム開始時、自動で前回のセーブデータをロードしてほしい
  - 実装完了: `src/core/game_manager.py`に自動ロード機能を実装
  - `_try_auto_load()`メソッドで最新セーブデータを自動検出・ロード
  - セーブデータが存在しない場合は従来通りテスト用パーティを作成
  - エラーハンドリング機能付き（ロード失敗時は新規ゲーム開始）
  - テストケース作成済み: `tests/test_auto_load_feature.py`

- [x] 地上のメニューボタンを左寄せにしてほしい
  - 実装完了: `src/overworld/overworld_manager.py`で既に`alignment="left"`が設定済み
  - 根本的修正: `src/ui/base_ui.py`でPanda3D標準の`text_align=TextNode.ALeft`を使用
  - UIButtonクラスに標準的なアライメント設定を実装
  - `align_map = {"left": TextNode.ALeft, "center": TextNode.ACenter, "right": TextNode.ARight}`
  - `text_pos`による位置微調整と組み合わせて確実な左寄せを実現
  - 地上メニューのボタン位置とテキストが標準的なPanda3D方式で左寄せ表示される

- [x] 各画面のボタン及び文字を更に小さくして、ボタンとボタンが重ならないようにしてほしい
  - 実装完了: `src/ui/base_ui.py`でボタンサイズとフォントサイズを縮小
  - 通常ボタンサイズ: `(0.35, 0.35)` → `(0.28, 0.28)`
  - キャラクター作成ボタンサイズ: `(0.28, 0.28)` → `(0.22, 0.22)`
  - フォントサイズ: 通常 0.5 → 0.42、キャラクター作成 0.4 → 0.35
  - ボタン間隔調整: 初期 0.15 → 0.12 → 最終 0.16（適度な間隔確保）
  - ダイアログボタンサイズも同様に縮小
  - ボタンが重ならず、かつ適度な間隔で見やすいレイアウトを実現

- [x] 各施設に入った後のメッセージと施設のメニューが同時に表示されている。各施設に入った後[OK]を押してメニューを出すようにするべき
  - 実装完了: `src/overworld/base_facility.py`に入場時ウェルカムメッセージ機能を追加
  - 施設入場時に`_show_welcome_message()`でウェルカムダイアログを表示
  - OKボタンを押した後に`_show_main_menu()`でメニューを表示
  - 各施設でカスタムウェルカムメッセージの設定が可能

